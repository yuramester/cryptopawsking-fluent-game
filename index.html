<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fluent - Three Levels Challenge</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', Arial, sans-serif;
            overflow: hidden;
            background: linear-gradient(135deg, #000 0%, #191970 60%, #4B0082 100%);
            height: 100vh;
            color: #F5F6FA;
        }

        .container {
            position: relative;
            width: 100vw;
            height: 100vh;
            display: flex;
        }

        .screen {
            width: 100vw;
            height: 100vh;
            position: absolute;
            top: 0;
            left: 0;
            z-index: 1;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.5s, transform 0.8s cubic-bezier(0.25, 0.46, 0.45, 0.94);
        }
        .screen.active {
            z-index: 2;
            opacity: 1;
            pointer-events: auto;
            transform: translateX(0);
        }

        .registration-screen,
        .landing-screen,
        .level-screen {
            background: linear-gradient(135deg, #000 0%, #191970 60%, #4B0082 100%);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            text-align: center;
            padding: 20px;
        }

        .game-screen {
            background: #000;
        }

        .center-logo {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            margin-bottom: 40px;
        }

        #fluentLogo {
            max-width: 180px;
            width: 30vw;
            margin-bottom: 0;
            display: block;
            cursor: pointer;
            filter: drop-shadow(0 0 32px #4B0082cc);
            transition: filter 0.3s;
        }

        #fluentLogo:hover {
            filter: drop-shadow(0 0 48px #4B0082ff);
        }

        .start-button, .level-button, .register-button, .leaderboard-button, .logout-button, .restart-button, .home-button, .levels-button {
            background: linear-gradient(90deg, #4B0082 0%, #191970 100%);
            border: none;
            padding: 22px 48px;
            font-size: 1.4rem;
            font-weight: 700;
            color: #fff;
            border-radius: 40px;
            cursor: pointer;
            margin: 18px 0;
            box-shadow: 0 8px 32px #0008, 0 0px 0px #4B0082;
            letter-spacing: 2px;
            transition: background 0.3s, box-shadow 0.3s, transform 0.2s;
        }

        .start-button:hover, .level-button:hover, .register-button:hover, .leaderboard-button:hover, .logout-button:hover, .restart-button:hover, .home-button:hover, .levels-button:hover {
            background: linear-gradient(90deg, #191970 0%, #4B0082 100%);
            box-shadow: 0 12px 40px #4B0082cc, 0 0px 0px #191970;
            transform: translateY(-4px) scale(1.04);
        }

        /* Main page buttons with special styling */
        .main-buttons .start-button {
            flex: 0 0 auto;
            z-index: 3;
            position: relative;
            transform: scale(1);
            opacity: 1;
            transition: all 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
        }

        .main-buttons .shop-button,
        .main-buttons .settings-button {
            flex: 0 0 auto;
            position: relative;
            width: 120px;
            height: 68px;
            overflow: hidden;
            border-radius: 40px;
            transform: scale(0.85);
            opacity: 0.7;
            transition: all 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
            z-index: 2;
            font-size: 1.1rem;
            padding: 18px 24px;
            margin: 18px 0;
        }

        .main-buttons .shop-button::before,
        .main-buttons .settings-button::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: inherit;
            border-radius: inherit;
            transition: all 0.4s ease;
            z-index: -1;
        }

        /* Hover effects for main buttons */
        .main-buttons:hover .start-button:not(:hover) {
            transform: scale(0.9);
            opacity: 0.6;
            filter: blur(1px);
        }

        .main-buttons:hover .shop-button:not(:hover),
        .main-buttons:hover .settings-button:not(:hover) {
            transform: scale(0.75);
            opacity: 0.4;
            filter: blur(2px);
        }

        .main-buttons .shop-button:hover,
        .main-buttons .settings-button:hover {
            transform: scale(1) !important;
            opacity: 1 !important;
            width: 200px;
            font-size: 1.4rem;
            padding: 22px 48px;
            z-index: 4;
            filter: blur(0px);
            box-shadow: 0 16px 48px rgba(0,0,0,0.3), 0 0 0 2px rgba(255,255,255,0.1);
        }

        .main-buttons .start-button:hover {
            transform: scale(1.05) !important;
            opacity: 1 !important;
            z-index: 4;
            filter: blur(0px);
        }

        .social-links {
            margin-top: 48px;
            display: flex;
            flex-direction: row;
            gap: 36px;
            justify-content: center;
            align-items: center;
        }

        .social-link {
            display: flex;
            align-items: center;
            gap: 10px;
            background: linear-gradient(135deg, #000 0%, #191970 60%, #4B0082 100%);
            color: #fff;
            text-decoration: none;
            font-weight: 600;
            font-size: 1.2rem;
            padding: 16px 32px;
            border-radius: 32px;
            box-shadow: 0 4px 18px #4B008233;
            transition: background 0.3s, color 0.3s, transform 0.2s, box-shadow 0.3s;
        }

        .social-link:hover {
            background: linear-gradient(135deg, #191970 0%, #4B0082 80%, #000 100%);
            color: #FFD700;
            transform: translateY(-3px) scale(1.07);
            box-shadow: 0 8px 32px #4B0082cc;
        }

        .social-link svg {
            width: 28px;
            height: 28px;
            fill: #fff;
            transition: fill 0.3s;
        }

        .social-link:hover svg {
            fill: #FFD700;
        }

        .subtitle, .level-subtitle {
            color: #B0B3C6;
            font-size: 1.3rem;
            margin-bottom: 32px;
            font-weight: 400;
        }

        .instructions {
            color: #B0B3C6;
            font-size: 1.1rem;
            margin-top: 32px;
        }

        .level-title {
            font-size: clamp(2rem, 6vw, 3.5rem);
            font-weight: bold;
            color: #FFFFFF;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
            margin-bottom: 30px;
        }

        .level-subtitle {
            font-size: clamp(1rem, 3vw, 1.3rem);
            color: #FFFFFF;
            margin-bottom: 40px;
            max-width: 500px;
        }

        .level-buttons {
            display: flex;
            flex-direction: column;
            gap: 20px;
            width: 100%;
            max-width: 400px;
        }

        .level-button.beginner {
            background: linear-gradient(45deg, #191970, #4B0082 80%, #000);
        }

        .level-button.intermediate {
            background: linear-gradient(45deg, #000, #191970 60%, #4B0082);
        }

        .level-button.expert {
            background: linear-gradient(45deg, #000, #4B0082 60%, #191970);
        }

        .level-info {
            display: block;
            font-size: clamp(0.8rem, 2vw, 1rem);
            margin-top: 5px;
            opacity: 0.9;
        }

        .back-button {
            position: absolute;
            top: 30px;
            left: 30px;
            background: rgba(255,255,255,0.2);
            border: 2px solid rgba(255,255,255,0.5);
            color: #FFFFFF;
            padding: 10px 20px;
            border-radius: 20px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s ease;
        }

        .back-button:hover {
            background: rgba(255,255,255,0.3);
            transform: translateY(-2px);
        }

        .bird-decoration {
            position: absolute;
            width: 60px;
            height: 60px;
            background: #FFD700;
            border-radius: 50%;
            animation: fly 4s ease-in-out infinite;
        }

        .bird-decoration:before {
            content: '';
            position: absolute;
            width: 20px;
            height: 15px;
            background: #FF6347;
            border-radius: 0 0 10px 10px;
            top: 20px;
            left: 45px;
        }

        .bird-decoration:after {
            content: '';
            position: absolute;
            width: 8px;
            height: 8px;
            background: #333;
            border-radius: 50%;
            top: 15px;
            left: 15px;
        }

        @keyframes fly {
            0%, 100% { transform: translate(0, 0) rotate(0deg); }
            25% { transform: translate(50px, -30px) rotate(-10deg); }
            50% { transform: translate(100px, 0) rotate(0deg); }
            75% { transform: translate(50px, 30px) rotate(10deg); }
        }

        .game-canvas {
            width: 100%;
            height: 100%;
            display: block;
            background: linear-gradient(to bottom, #000 0%, #191970 60%, #4B0082 100%);
            position: relative;
        }

        .game-ui {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 10;
        }

        .score {
            position: absolute;
            top: 30px;
            left: 50%;
            transform: translateX(-50%);
            font-size: clamp(2rem, 6vw, 4rem);
            font-weight: bold;
            color: white;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
        }

        .level-progress {
            position: absolute;
            top: 80px;
            left: 50%;
            transform: translateX(-50%);
            font-size: clamp(1rem, 3vw, 1.5rem);
            font-weight: bold;
            color: white;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
            background: rgba(0,0,0,0.3);
            padding: 10px 20px;
            border-radius: 20px;
        }

        .game-over, .level-complete {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: linear-gradient(135deg, rgba(0,0,0,0.9) 0%, rgba(25,25,112,0.9) 50%, rgba(75,0,130,0.9) 100%);
            padding: 40px;
            border-radius: 20px;
            text-align: center;
            color: white;
            display: none;
            pointer-events: all;
            min-width: 300px;
            border: 2px solid rgba(75,0,130,0.5);
            box-shadow: 0 8px 32px rgba(75,0,130,0.3);
        }

        .game-over h2 {
            font-size: clamp(2rem, 5vw, 3rem);
            margin-bottom: 20px;
            color: #FF6B6B;
        }

        .level-complete h2 {
            font-size: clamp(2rem, 5vw, 3rem);
            margin-bottom: 20px;
            color: #32CD32;
        }

        .game-over p, .level-complete p {
            font-size: clamp(1rem, 3vw, 1.5rem);
            margin-bottom: 30px;
        }

        .registration-form {
            display: flex;
            flex-direction: column;
            gap: 20px;
            width: 100%;
            max-width: 400px;
            margin-bottom: 30px;
        }

        .input-group {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .input-label {
            font-size: clamp(1rem, 3vw, 1.3rem);
            color: #FFFFFF;
            font-weight: bold;
        }

        .username-input {
            padding: 15px 20px;
            font-size: clamp(1rem, 3vw, 1.2rem);
            border: 2px solid rgba(255,255,255,0.3);
            border-radius: 25px;
            background: rgba(255,255,255,0.1);
            color: #FFFFFF;
            text-align: center;
            transition: all 0.3s ease;
        }

        .username-input:focus {
            outline: none;
            border-color: rgba(255,255,255,0.6);
            background: rgba(255,255,255,0.2);
        }

        .username-input::placeholder {
            color: rgba(255,255,255,0.6);
        }

        .user-info {
            position: absolute;
            top: 30px;
            right: 30px;
            display: flex;
            flex-direction: column;
            align-items: flex-end;
            gap: 10px;
        }

        .logout-container {
            position: absolute;
            top: 30px;
            left: 30px;
        }

        .username-display {
            color: #FFFFFF;
            font-size: clamp(1rem, 2.5vw, 1.2rem);
            font-weight: bold;
            background: rgba(0,0,0,0.3);
            padding: 8px 15px;
            border-radius: 15px;
        }

        .coins-display {
            color: #FFD700;
            font-size: clamp(0.9rem, 2.2vw, 1.1rem);
            font-weight: bold;
            background: rgba(0,0,0,0.3);
            padding: 6px 12px;
            border-radius: 12px;
            margin-top: 5px;
        }

        .coins-game-display {
            position: absolute;
            top: 30px;
            right: 30px;
            font-size: clamp(1.2rem, 3vw, 1.8rem);
            font-weight: bold;
            color: #FFD700;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
            background: rgba(0,0,0,0.3);
            padding: 10px 15px;
            border-radius: 15px;
        }

        .main-buttons {
            display: flex;
            gap: 30px;
            justify-content: center;
            align-items: center;
            flex-wrap: nowrap;
            position: relative;
            width: 100%;
            max-width: 900px;
            margin: 0 auto;
        }

        .shop-button {
            background: linear-gradient(90deg, #FF6B35 0%, #F7931E 100%);
            border: none;
            padding: 22px 48px;
            font-size: 1.4rem;
            font-weight: 700;
            color: #fff;
            border-radius: 40px;
            cursor: pointer;
            margin: 18px 0;
            box-shadow: 0 8px 32px #0008, 0 0px 0px #FF6B35;
            letter-spacing: 2px;
            transition: background 0.3s, box-shadow 0.3s, transform 0.2s;
        }

        .shop-button:hover {
            background: linear-gradient(90deg, #F7931E 0%, #FF6B35 100%);
            box-shadow: 0 12px 40px #FF6B35cc, 0 0px 0px #F7931E;
            transform: translateY(-4px) scale(1.04);
        }

        .settings-button {
            background: linear-gradient(90deg, #6C5CE7 0%, #A29BFE 100%);
            border: none;
            padding: 22px 48px;
            font-size: 1.4rem;
            font-weight: 700;
            color: #fff;
            border-radius: 40px;
            cursor: pointer;
            margin: 18px 0;
            box-shadow: 0 8px 32px #0008, 0 0px 0px #6C5CE7;
            letter-spacing: 2px;
            transition: background 0.3s, box-shadow 0.3s, transform 0.2s;
        }

        .settings-button:hover {
            background: linear-gradient(90deg, #A29BFE 0%, #6C5CE7 100%);
            box-shadow: 0 12px 40px #6C5CE7cc, 0 0px 0px #A29BFE;
            transform: translateY(-4px) scale(1.04);
        }

        /* Override hover effects for non-main page buttons */
        .shop-button:not(.main-buttons .shop-button):hover,
        .settings-button:not(.main-buttons .settings-button):hover {
            transform: translateY(-4px) scale(1.04) !important;
            width: auto !important;
            font-size: 1.4rem !important;
            opacity: 1 !important;
            filter: none !important;
        }

        .shop-screen, .settings-screen {
            background: linear-gradient(135deg, #000 0%, #191970 60%, #4B0082 100%);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            text-align: center;
            padding: 20px;
        }

        .shop-title {
            font-size: clamp(2rem, 6vw, 3.5rem);
            font-weight: bold;
            color: #FFFFFF;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
            margin-bottom: 30px;
        }

        .shop-subtitle {
            font-size: clamp(1rem, 3vw, 1.3rem);
            color: #B0B3C6;
            margin-bottom: 30px;
        }

        .current-skin-display {
            background: rgba(0,0,0,0.3);
            color: #FFD700;
            padding: 15px 25px;
            border-radius: 20px;
            font-size: 1.2rem;
            font-weight: bold;
            margin-bottom: 40px;
            border: 2px solid rgba(255,215,0,0.3);
        }

        .skins-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 25px;
            max-width: 900px;
            width: 100%;
        }

        .skin-item {
            background: rgba(255,255,255,0.1);
            border: 2px solid rgba(255,255,255,0.2);
            border-radius: 20px;
            padding: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
            transition: all 0.3s ease;
            position: relative;
        }

        .skin-item:hover {
            background: rgba(255,255,255,0.15);
            border-color: rgba(255,255,255,0.4);
            transform: translateY(-5px);
        }

        .skin-item.active {
            border-color: #FFD700;
            background: rgba(255,215,0,0.1);
        }

        .skin-preview {
            width: 80px;
            height: 60px;
            border-radius: 50%;
            margin-bottom: 15px;
            position: relative;
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
        }

        .default-preview {
            background: linear-gradient(45deg, #FFD700, #FFA500);
        }

        .red-preview {
            background: linear-gradient(45deg, #FF4444, #CC0000);
        }

        .green-preview {
            background: linear-gradient(45deg, #44FF44, #00AA00);
        }

        .blue-preview {
            background: linear-gradient(45deg, #4488FF, #0066CC);
        }

        .rainbow-preview {
            background: linear-gradient(45deg, #FF69B4, #9D5BD2, #FFD700);
            animation: rainbow-shimmer 2s ease-in-out infinite;
        }

        @keyframes rainbow-shimmer {
            0%, 100% { 
                background: linear-gradient(45deg, #FF69B4, #9D5BD2, #FFD700);
                transform: scale(1);
            }
            50% { 
                background: linear-gradient(45deg, #9D5BD2, #FFD700, #FF69B4);
                transform: scale(1.05);
            }
        }

        .rainbow-skin {
            border: 2px solid transparent;
            background: linear-gradient(white, white) padding-box,
                        linear-gradient(45deg, #FF69B4, #9D5BD2, #FFD700) border-box;
            animation: rainbow-border 3s linear infinite;
        }

        @keyframes rainbow-border {
            0% { 
                background: linear-gradient(white, white) padding-box,
                            linear-gradient(0deg, #FF69B4, #9D5BD2, #FFD700) border-box;
            }
            33% { 
                background: linear-gradient(white, white) padding-box,
                            linear-gradient(120deg, #9D5BD2, #FFD700, #FF69B4) border-box;
            }
            66% { 
                background: linear-gradient(white, white) padding-box,
                            linear-gradient(240deg, #FFD700, #FF69B4, #9D5BD2) border-box;
            }
            100% { 
                background: linear-gradient(white, white) padding-box,
                            linear-gradient(360deg, #FF69B4, #9D5BD2, #FFD700) border-box;
            }
        }

        .skin-preview::after {
            content: '';
            position: absolute;
            width: 8px;
            height: 8px;
            background: #333;
            border-radius: 50%;
            top: 15px;
            left: 25px;
        }

        .skin-name {
            font-size: 1.1rem;
            font-weight: bold;
            color: #FFFFFF;
            margin-bottom: 10px;
        }

        .skin-price {
            font-size: 1rem;
            color: #FFD700;
            margin-bottom: 15px;
            font-weight: bold;
        }

        .skin-button {
            background: linear-gradient(90deg, #4B0082 0%, #191970 100%);
            border: none;
            padding: 10px 20px;
            font-size: 1rem;
            font-weight: 600;
            color: #fff;
            border-radius: 20px;
            cursor: pointer;
            transition: all 0.3s ease;
            min-width: 100px;
        }

        .skin-button:hover:not(:disabled) {
            background: linear-gradient(90deg, #191970 0%, #4B0082 100%);
            transform: scale(1.05);
        }

        .skin-button.equipped {
            background: linear-gradient(90deg, #32CD32 0%, #228B22 100%);
            cursor: default;
        }

        .skin-button.select-button {
            background: linear-gradient(90deg, #FF6B35 0%, #F7931E 100%);
        }

        .skin-button.select-button:hover {
            background: linear-gradient(90deg, #F7931E 0%, #FF6B35 100%);
        }

        .skin-button:disabled {
            opacity: 0.7;
            cursor: not-allowed;
        }

        .settings-title {
            font-size: clamp(2rem, 6vw, 3.5rem);
            font-weight: bold;
            color: #FFFFFF;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
            margin-bottom: 30px;
        }

        .settings-subtitle {
            font-size: clamp(1rem, 3vw, 1.3rem);
            color: #B0B3C6;
            margin-bottom: 40px;
        }

        .settings-container {
            width: 100%;
            max-width: 800px;
            display: flex;
            flex-direction: column;
            gap: 30px;
        }

        .settings-section {
            background: rgba(255,255,255,0.1);
            border: 2px solid rgba(255,255,255,0.2);
            border-radius: 20px;
            padding: 25px;
            text-align: left;
        }

        .section-title {
            font-size: 1.4rem;
            font-weight: bold;
            color: #FFFFFF;
            margin-bottom: 20px;
            text-align: center;
        }

        .setting-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 0;
            border-bottom: 1px solid rgba(255,255,255,0.1);
        }

        .setting-item:last-child {
            border-bottom: none;
        }

        .setting-label {
            font-size: 1.1rem;
            color: #FFFFFF;
            font-weight: 500;
        }

        .toggle-switch {
            width: 60px;
            height: 30px;
            background: rgba(255,255,255,0.2);
            border-radius: 15px;
            position: relative;
            cursor: pointer;
            transition: background 0.3s;
        }

        .toggle-switch.active {
            background: #32CD32;
        }

        .toggle-slider {
            width: 26px;
            height: 26px;
            background: white;
            border-radius: 50%;
            position: absolute;
            top: 2px;
            left: 2px;
            transition: left 0.3s;
        }

        .toggle-switch.active .toggle-slider {
            left: 32px;
        }

        .developer-panel {
            display: flex;
            flex-direction: column;
            gap: 15px;
            align-items: center;
        }

        .cheat-label {
            font-size: 1.1rem;
            color: #FFFFFF;
            font-weight: 500;
            text-align: center;
        }

        .cheat-input {
            padding: 12px 20px;
            font-size: 1.1rem;
            border: 2px solid rgba(255,255,255,0.3);
            border-radius: 25px;
            background: rgba(0,0,0,0.3);
            color: #FFFFFF;
            text-align: center;
            width: 200px;
            letter-spacing: 3px;
            transition: all 0.3s ease;
        }

        .cheat-input:focus {
            outline: none;
            border-color: #6C5CE7;
            background: rgba(0,0,0,0.5);
        }

        .cheat-input::placeholder {
            color: rgba(255,255,255,0.5);
            letter-spacing: 1px;
        }

        .cheat-button {
            background: linear-gradient(90deg, #6C5CE7 0%, #A29BFE 100%);
            border: none;
            padding: 12px 30px;
            font-size: 1rem;
            font-weight: 600;
            color: #fff;
            border-radius: 25px;
            cursor: pointer;
            transition: all 0.3s ease;
            min-width: 120px;
        }

        .cheat-button:hover {
            background: linear-gradient(90deg, #A29BFE 0%, #6C5CE7 100%);
            transform: scale(1.05);
        }

        .cheat-message {
            font-size: 1rem;
            font-weight: bold;
            text-align: center;
            padding: 10px;
            border-radius: 10px;
            min-height: 20px;
            transition: all 0.3s ease;
        }

        .cheat-message.success {
            color: #32CD32;
            background: rgba(50, 205, 50, 0.1);
            border: 1px solid rgba(50, 205, 50, 0.3);
        }

        .cheat-message.error {
            color: #FF6B6B;
            background: rgba(255, 107, 107, 0.1);
            border: 1px solid rgba(255, 107, 107, 0.3);
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 20px;
            margin-top: 15px;
        }

        .stat-item {
            background: rgba(0,0,0,0.3);
            border-radius: 15px;
            padding: 20px;
            text-align: center;
            border: 1px solid rgba(255,255,255,0.1);
        }

        .stat-value {
            font-size: 2rem;
            font-weight: bold;
            color: #FFD700;
            margin-bottom: 8px;
        }

        .stat-label {
            font-size: 0.9rem;
            color: #B0B3C6;
            font-weight: 500;
        }

        @media (max-width: 768px) {
            .landing-screen, .level-screen, .shop-screen, .settings-screen {
                padding: 15px;
            }
            
            .bird-decoration {
                width: 40px;
                height: 40px;
            }
            
            .main-buttons {
                flex-direction: column;
                gap: 15px;
                max-width: 100%;
            }
            
            .main-buttons .start-button,
            .main-buttons .shop-button,
            .main-buttons .settings-button {
                transform: scale(1) !important;
                opacity: 1 !important;
                width: auto !important;
                padding: 15px 30px !important;
                font-size: 1rem !important;
                filter: none !important;
            }
            
            .main-buttons:hover .start-button:not(:hover),
            .main-buttons:hover .shop-button:not(:hover),
            .main-buttons:hover .settings-button:not(:hover) {
                transform: scale(1) !important;
                opacity: 1 !important;
                filter: none !important;
            }
            
            .start-button, .shop-button, .settings-button {
                padding: 15px 30px;
            }
            
            .settings-container {
                gap: 20px;
            }
            
            .settings-section {
                padding: 20px;
            }
            
            .stats-grid {
                grid-template-columns: repeat(2, 1fr);
                gap: 15px;
            }
            
            .cheat-input {
                width: 180px;
                font-size: 1rem;
            }

            .level-buttons {
                gap: 15px;
            }
            
            .skins-grid {
                grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
                gap: 15px;
            }
            
            .skin-item {
                padding: 15px;
            }
            
            .skin-preview {
                width: 60px;
                height: 45px;
            }

            .back-button {
                top: 20px;
                left: 20px;
                padding: 8px 15px;
                font-size: 0.9rem;
            }
            .center-logo #fluentLogo {
                max-width: 120px;
            }
            .social-links {
                gap: 16px;
            }
            .start-button, .level-button, .register-button, .leaderboard-button, .logout-button, .restart-button, .home-button, .levels-button, .shop-button, .settings-button {
                padding: 14px 18px;
                font-size: 1rem;
            }
        }

        .title {
            font-size: clamp(2.5rem, 8vw, 4rem);
            font-weight: bold;
            color: #FFFFFF;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
            margin-bottom: 20px;
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Registration Screen -->
        <div class="screen registration-screen active" id="registrationScreen">
            <div class="bird-decoration" style="top: 15%; right: 15%;"></div>
            <div class="bird-decoration" style="bottom: 20%; left: 10%; animation-delay: -2s;"></div>
            
            <div class="center-logo">
                <img src="fluent-logo.png" alt="Fluent Logo" id="fluentLogo" onclick="handleLogoClick()" />
            </div>
            <p class="subtitle">Welcome! Please enter your username to start playing</p>
            
            <div class="registration-form">
                <div class="input-group">
                    <label class="input-label" for="usernameInput">Your Nickname:</label>
                    <input type="text" 
                           id="usernameInput" 
                           class="username-input" 
                           placeholder="Enter your nickname..."
                           maxlength="20"
                           autocomplete="off">
                </div>
                <button class="register-button" onclick="registerUser()" id="registerBtn">
                    <span id="registerBtnText">Start Playing</span>
                </button>
            </div>
            
            <div class="saved-user-info" id="savedUserInfo" style="display: none; margin-top: 20px; color: #FFD700; font-size: 1rem;">
                üíæ Welcome back! Your progress has been saved.
            </div>
            
            <div class="instructions">
                <p>üéÆ Choose a cool username and join the competition!</p>
            </div>
        </div>

        <!-- Landing Screen -->
        <div class="screen landing-screen" id="landingScreen">
            <div class="bird-decoration" style="top: 15%; right: 15%;"></div>
            <div class="bird-decoration" style="bottom: 20%; left: 10%; animation-delay: -2s;"></div>
            <div class="center-logo">
                <img src="fluent-logo.png" alt="Fluent Logo" id="fluentLogo" onclick="handleLogoClick()" />
            </div>
            <div class="logout-container">
                <button class="logout-button" onclick="logout()">üö™ Logout</button>
            </div>
            <div class="user-info">
                <div class="username-display" id="usernameDisplay">Player</div>
                <div class="coins-display" id="coinsDisplay">üí∞ 0 coins</div>
            </div>
            <p class="subtitle">Challenge yourself with three exciting difficulty levels!</p>
            <div class="main-buttons">
                <button class="shop-button" onclick="showShop()">üõí</button>
                <button class="start-button" onclick="showLevelSelection()">Start Game</button>
                <button class="settings-button" onclick="showSettings()">‚öôÔ∏è</button>
            </div>
            <div class="social-links">
                <a class="social-link" href="https://x.com/fluentxyz" target="_blank" rel="noopener" title="X">
                    <svg viewBox="0 0 120 120"><path d="M87.6 18.6H108L74.4 58.2L114 108H83.4L59.4 78.6L32.4 108H12L48.6 65.4L10.2 18.6H41.4L62.4 45L87.6 18.6ZM82.2 99H91.2L42.6 27H33L82.2 99Z"/></svg>
                    X
                </a>
                <a class="social-link" href="https://linktr.ee/fluentxyz" target="_blank" rel="noopener" title="Linktree">
                    <svg viewBox="0 0 24 24"><path d="M12 2c.552 0 1 .448 1 1v7.586l2.293-2.293a1 1 0 1 1 1.414 1.414L13 13.414V21a1 1 0 1 1-2 0v-7.586l-3.707-3.707a1 1 0 1 1 1.414-1.414L11 10.586V3c0-.552.448-1 1-1z"/></svg>
                    Linktree
                </a>
                <a class="social-link" href="https://discord.gg/fluentxyz" target="_blank" rel="noopener" title="Discord">
                    <svg viewBox="0 0 24 24"><path d="M20.317 4.37a19.791 19.791 0 0 0-4.885-1.515.074.074 0 0 0-.079.037c-.21.375-.444.864-.608 1.25a18.27 18.27 0 0 0-5.487 0 12.64 12.64 0 0 0-.617-1.25.077.077 0 0 0-.079-.037A19.736 19.736 0 0 0 3.677 4.37a.07.07 0 0 0-.032.027C.533 9.046-.32 13.58.099 18.057a.082.082 0 0 0 .031.057 19.9 19.9 0 0 0 5.993 3.03.078.078 0 0 0 .084-.028c.462-.63.874-1.295 1.226-1.994a.076.076 0 0 0-.041-.106 13.107 13.107 0 0 1-1.872-.892.077.077 0 0 1-.008-.128 10.2 10.2 0 0 0 .372-.292.074.074 0 0 1 .077-.01c3.928 1.793 8.18 1.793 12.062 0a.074.074 0 0 1 .078.01c.12.098.246.198.373.292a.077.077 0 0 1-.006.127 12.299 12.299 0 0 1-1.873.892.077.077 0 0 0-.041.107c.36.698.772 1.362 1.225 1.993a.076.076 0 0 0 .084.028 19.839 19.839 0 0 0 6.002-3.03.077.077 0 0 0 .032-.054c.5-5.177-.838-9.674-3.549-13.66a.061.061 0 0 0-.031-.03zM8.02 15.33c-1.183 0-2.157-1.085-2.157-2.419 0-1.333.956-2.419 2.157-2.419 1.21 0 2.176 1.096 2.157 2.42 0 1.333-.956 2.418-2.157 2.418zm7.975 0c-1.183 0-2.157-1.085-2.157-2.419 0-1.333.955-2.419 2.157-2.419 1.21 0 2.176 1.096 2.157 2.42 0 1.333-.946 2.418-2.157 2.418z"/></svg>
                    Discord
                </a>
            </div>
            <div class="instructions">
                <p>üñ±Ô∏è Click or Tap to Fly</p>
            </div>
        </div>

        <!-- Level Selection Screen -->
        <div class="screen level-screen" id="levelScreen">
            <button class="back-button" onclick="goHome()">‚Üê Back</button>
            
            <h1 class="level-title">Choose Your Challenge</h1>
            <p class="level-subtitle">Select a difficulty level and test your skills!</p>
            
            <div class="level-buttons" id="levelButtons">
                <button class="level-button beginner" onclick="startGame('beginner')">
                    üåü Fluent Beginner
                    <span class="level-info">Goal: Score 15 points ‚Ä¢ Reward: üí∞ 20 coins</span>
                </button>
                <button class="level-button intermediate" onclick="startGame('intermediate')">
                    üî• Fluent Intermediate
                    <span class="level-info">Goal: Score 35 points ‚Ä¢ Reward: üí∞ 45 coins</span>
                </button>
                <button class="level-button expert" onclick="startGame('expert')">
                    ‚ö° Fluent Expert
                    <span class="level-info">Goal: Score 75 points ‚Ä¢ Reward: üí∞ 100 coins</span>
                </button>
                <button class="level-button" onclick="startGame('freeplay')">
                    ‚àû Free Play
                    <span class="level-info">Endless mode ‚Ä¢ üí∞ 1 coin per point</span>
                </button>
            </div>
        </div>

        <!-- Shop Screen -->
        <div class="screen shop-screen" id="shopScreen">
            <button class="back-button" onclick="goHome()">‚Üê Back</button>
            
            <h1 class="shop-title">üõí Bird Shop</h1>
            <p class="shop-subtitle">Customize your bird with different skins!</p>
            <div class="current-skin-display" id="currentSkinDisplay">
                Current: üê§ Fluent Bird
            </div>
            
            <div class="skins-grid" id="skinsGrid">
                <div class="skin-item default-skin active" data-skin="default">
                    <div class="skin-preview default-preview"></div>
                    <div class="skin-name">üê§ Fluent Bird</div>
                    <div class="skin-price">FREE</div>
                    <button class="skin-button equipped" disabled>Equipped</button>
                </div>
                
                <div class="skin-item red-skin" data-skin="red">
                    <div class="skin-preview red-preview"></div>
                    <div class="skin-name">üî¥ Fire Fluent Bird</div>
                    <div class="skin-price">üí∞ 25 coins</div>
                    <button class="skin-button buy-button" onclick="buySkin('red', 25)">Buy</button>
                </div>
                
                <div class="skin-item green-skin" data-skin="green">
                    <div class="skin-preview green-preview"></div>
                    <div class="skin-name">üü¢ Forest Fluent Bird</div>
                    <div class="skin-price">üí∞ 20 coins</div>
                    <button class="skin-button buy-button" onclick="buySkin('green', 20)">Buy</button>
                </div>
                
                <div class="skin-item blue-skin" data-skin="blue">
                    <div class="skin-preview blue-preview"></div>
                    <div class="skin-name">üîµ Ice Fluent Bird</div>
                    <div class="skin-price">üí∞ 30 coins</div>
                    <button class="skin-button buy-button" onclick="buySkin('blue', 30)">Buy</button>
                </div>
                
                <div class="skin-item rainbow-skin" data-skin="rainbow" style="display: none;">
                    <div class="skin-preview rainbow-preview"></div>
                    <div class="skin-name">üåà Rainbow Fluent Bird</div>
                    <div class="skin-price">‚ú® SPECIAL</div>
                    <button class="skin-button equipped" disabled>Secret</button>
                </div>
            </div>
        </div>

        <!-- Settings Screen -->
        <div class="screen settings-screen" id="settingsScreen">
            <button class="back-button" onclick="goHome()">‚Üê Back</button>
            
            <h1 class="settings-title">‚öôÔ∏è Settings</h1>
            <p class="settings-subtitle">Game configuration and developer options</p>
            
            <div class="settings-container">
                <div class="settings-section">
                    <h3 class="section-title">üéÆ Game Settings</h3>
                    <div class="setting-item">
                        <label class="setting-label">Sound Effects</label>
                        <div class="toggle-switch" onclick="toggleSetting('sounds')">
                            <div class="toggle-slider" id="soundsToggle"></div>
                        </div>
                    </div>
                    <div class="setting-item">
                        <label class="setting-label">Vibration</label>
                        <div class="toggle-switch" onclick="toggleSetting('vibration')">
                            <div class="toggle-slider" id="vibrationToggle"></div>
                        </div>
                    </div>
                </div>
                
                <div class="settings-section" id="developerSection" style="display: none;">
                    <h3 class="section-title">üë®‚Äçüíª Developer Panel</h3>
                    <div class="developer-panel">
                        <label class="cheat-label">Enter Developer Code:</label>
                        <input type="password" 
                               id="cheatCodeInput" 
                               class="cheat-input" 
                               placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢"
                               maxlength="15">
                        <button class="cheat-button" onclick="executeCheatCode()">Execute</button>
                        <div class="cheat-message" id="cheatMessage"></div>
                    </div>
                </div>
                
                <div class="settings-section">
                    <h3 class="section-title">üìä Statistics</h3>
                    <div class="stats-grid">
                        <div class="stat-item">
                            <div class="stat-value" id="totalCoins">0</div>
                            <div class="stat-label">Total Coins</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-value" id="totalSkins">1</div>
                            <div class="stat-label">Owned Skins</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-value" id="gamesPlayed">0</div>
                            <div class="stat-label">Games Played</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-value" id="bestScore">0</div>
                            <div class="stat-label">Best Score</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Game Screen -->
        <div class="screen game-screen" id="gameScreen">
            <canvas class="game-canvas" id="gameCanvas" style="touch-action: manipulation;"></canvas>
            <div class="game-ui">
                <div class="score" id="score">0</div>
                <div class="level-progress" id="levelProgress">Fluent Beginner: 0/10</div>
                <div class="coins-game-display" id="coinsGameDisplay">üí∞ 0</div>
                
                <div class="game-over" id="gameOver">
                    <h2>Game Over!</h2>
                    <p id="finalScore">Score: 0</p>
                    <p id="earnedCoinsDisplay" style="color: #FFD700; font-size: 1.3rem; margin: 10px 0;">üí∞ +0 coins earned</p>
                    <button class="restart-button" onclick="restartGame()">Try Again</button>
                    <button class="levels-button" onclick="goToLevels()">Change Level</button>
                    <button class="home-button" onclick="goHome()">Home</button>
                </div>

                <div class="level-complete" id="levelComplete">
                    <h2>üéâ Level Complete!</h2>
                    <p id="completionMessage">Congratulations!</p>
                    <p id="levelRewardDisplay" style="color: #FFD700; font-size: 1.5rem; margin: 15px 0;">üí∞ +0 coins earned!</p>
                    <button class="levels-button" onclick="goToLevels()">Choose Level</button>
                    <button class="home-button" onclick="goHome()">Home</button>
                </div>
                
                <div class="instructions" id="gameInstructions">
                    Tap to Fly!
                </div>
            </div>
        </div>
    </div>

    <script type="module">
        // Game Variables
        let canvas, ctx;
        let gameStarted = false;
        let gameOver = false;
        let levelComplete = false;
        let score = 0;
        let animationId;
        let currentLevel = 'beginner';
        let currentUser = null;
        let coins = 0;
        let earnedCoins = 0;
        let currentSkin = 'default';
        let ownedSkins = ['default'];
        
        // Settings variables
        let soundsEnabled = true;
        let vibrationEnabled = true;
        let gamesPlayed = 0;
        let bestScore = 0;
        
        // Developer Panel variables
        let logoClickCount = 0;
        let logoClickTimer = null;
        let developerPanelUnlocked = false;
        
        // Watermark logo with error handling
        let fluentWatermarkImg = new Image();
        fluentWatermarkImg.crossOrigin = 'anonymous';
        fluentWatermarkImg.onerror = () => {
            console.warn('Failed to load watermark image');
        };
        fluentWatermarkImg.src = 'DMRym4WhCY8ejNl5qSuAh';

        // Level configurations with mobile adaptations - PROGRESSIVE SPEED INCREASE + COIN REWARDS
        const isMobile = window.innerWidth < 768;
        const levels = {
            beginner: {
                name: 'Fluent Beginner',
                goal: 15,
                gravity: isMobile ? 0.28 : 0.32,
                jumpStrength: isMobile ? -7 : -8, // Reduced jump strength
                pipeSpeed: isMobile ? 2.8 : 3.5, // Increased from 2/2.5
                pipeGap: isMobile ? 240 : 220,
                emoji: 'üåü',
                coinReward: 20
            },
            intermediate: {
                name: 'Fluent Intermediate',
                goal: 35,
                gravity: isMobile ? 0.32 : 0.38,
                jumpStrength: isMobile ? -7.5 : -8.5, // Reduced jump strength
                pipeSpeed: isMobile ? 3.8 : 4.8, // Increased from 2.5/3.2
                pipeGap: isMobile ? 210 : 190,
                emoji: 'üî•',
                coinReward: 45
            },
            expert: {
                name: 'Fluent Expert',
                goal: 75,
                gravity: isMobile ? 0.38 : 0.45,
                jumpStrength: isMobile ? -8 : -9, // Reduced jump strength
                pipeSpeed: isMobile ? 5.2 : 6.5, // Increased from 3.2/4
                pipeGap: isMobile ? 180 : 160,
                emoji: '‚ö°',
                coinReward: 100
            },
            freeplay: {
                name: 'Free Play',
                goal: Infinity,
                gravity: isMobile ? 0.35 : 0.42,
                jumpStrength: isMobile ? -7.8 : -8.8, // Reduced jump strength
                pipeSpeed: isMobile ? 4.5 : 5.5, // Increased from 2.8/3.5
                pipeGap: isMobile ? 200 : 180,
                emoji: '‚àû',
                coinReward: 1 // Per point in freeplay
            }
        };

        // Skin system
        const skins = {
            default: {
                name: 'üê§ Fluent Bird',
                body: '#FFD700',
                wing: '#FFA500',
                beak: '#FF6347',
                price: 0,
                emoji: 'üê§'
            },
            red: {
                name: 'üî¥ Fire Fluent Bird',
                body: '#FF4444',
                wing: '#CC0000',
                beak: '#8B0000',
                price: 25,
                emoji: 'üî¥'
            },
            green: {
                name: 'üü¢ Forest Fluent Bird',
                body: '#44FF44',
                wing: '#00AA00',
                beak: '#006600',
                price: 20,
                emoji: 'üü¢'
            },
            blue: {
                name: 'üîµ Ice Fluent Bird',
                body: '#4488FF',
                wing: '#0066CC',
                beak: '#003399',
                price: 30,
                emoji: 'üîµ'
            },
            rainbow: {
                name: 'üåà Rainbow Fluent Bird',
                body: '#FF69B4',
                wing: '#9D5BD2',
                beak: '#FFD700',
                price: 0,
                emoji: 'üåà',
                special: true
            }
        };

        // Bird properties
        let bird = {
            x: 100,
            y: 250,
            width: 40,
            height: 30,
            velocity: 0,
            gravity: 0.3,
            jumpStrength: -6.5, // Reduced default jump strength
            rotation: 0
        };

        // Pipes array
        let pipes = [];
        const pipeWidth = 80;
        let pipeSpeed = 2;
        let pipeGap = 220;

        // Background elements
        let clouds = [];

        // Coin Management Functions
        function loadCoins() {
            const savedCoins = localStorage.getItem(`fluent_coins_${currentUser}`);
            coins = savedCoins ? parseInt(savedCoins) : 0;
            updateCoinsDisplay();
        }

        function saveCoins() {
            localStorage.setItem(`fluent_coins_${currentUser}`, coins.toString());
        }

        function addCoins(amount) {
            coins += amount;
            earnedCoins += amount;
            saveCoins();
            updateCoinsDisplay();
        }

        function updateCoinsDisplay() {
            document.getElementById('coinsDisplay').textContent = `üí∞ ${coins} coins`;
            document.getElementById('coinsGameDisplay').textContent = `üí∞ ${coins}`;
        }

        // Skin Management Functions
        function loadSkins() {
            const savedSkins = localStorage.getItem(`fluent_skins_${currentUser}`);
            const savedCurrentSkin = localStorage.getItem(`fluent_current_skin_${currentUser}`);
            
            ownedSkins = savedSkins ? JSON.parse(savedSkins) : ['default'];
            currentSkin = savedCurrentSkin || 'default';
            
            // Ensure default skin is always owned
            if (!ownedSkins.includes('default')) {
                ownedSkins.push('default');
            }
            
            updateShopUI();
        }

        function saveSkins() {
            localStorage.setItem(`fluent_skins_${currentUser}`, JSON.stringify(ownedSkins));
            localStorage.setItem(`fluent_current_skin_${currentUser}`, currentSkin);
        }

        function buySkin(skinId, price) {
            if (coins < price) {
                alert(`Not enough coins! You need ${price} coins but only have ${coins}.`);
                return;
            }
            
            if (ownedSkins.includes(skinId)) {
                alert('You already own this skin!');
                return;
            }
            
            coins -= price;
            ownedSkins.push(skinId);
            saveCoins();
            saveSkins();
            updateCoinsDisplay();
            updateShopUI();
            
            alert(`üéâ Congratulations! You bought the ${skins[skinId].name} skin!`);
        }

        function selectSkin(skinId) {
            if (!ownedSkins.includes(skinId)) {
                alert('You don\'t own this skin!');
                return;
            }
            
            currentSkin = skinId;
            saveSkins();
            updateShopUI();
        }

        function updateShopUI() {
            // Update current skin display
            const currentSkinDisplay = document.getElementById('currentSkinDisplay');
            if (currentSkinDisplay) {
                currentSkinDisplay.textContent = `Current: ${skins[currentSkin].name}`;
            }
            
            // Update skin items
            Object.keys(skins).forEach(skinId => {
                const skinItem = document.querySelector(`[data-skin="${skinId}"]`);
                if (!skinItem) return;
                
                const isOwned = ownedSkins.includes(skinId);
                const isEquipped = currentSkin === skinId;
                const skinButton = skinItem.querySelector('.skin-button');
                const skin = skins[skinId];
                
                // Special handling for rainbow skin
                if (skinId === 'rainbow') {
                    if (isOwned) {
                        skinItem.style.display = 'block';
                    } else {
                        skinItem.style.display = 'none';
                        return;
                    }
                }
                
                // Remove all classes
                skinItem.classList.remove('active');
                skinButton.classList.remove('equipped', 'select-button', 'buy-button');
                
                if (isEquipped) {
                    skinItem.classList.add('active');
                    skinButton.textContent = skin.special ? 'Equipped ‚ú®' : 'Equipped';
                    skinButton.classList.add('equipped');
                    skinButton.disabled = true;
                    skinButton.onclick = null;
                } else if (isOwned) {
                    skinButton.textContent = skin.special ? 'Select ‚ú®' : 'Select';
                    skinButton.classList.add('select-button');
                    skinButton.disabled = false;
                    skinButton.onclick = () => selectSkin(skinId);
                } else if (skin.special) {
                    skinButton.textContent = 'Secret';
                    skinButton.classList.add('buy-button');
                    skinButton.disabled = true;
                    skinButton.onclick = null;
                } else {
                    skinButton.textContent = 'Buy';
                    skinButton.classList.add('buy-button');
                    skinButton.disabled = false;
                    skinButton.onclick = () => buySkin(skinId, skin.price);
                }
            });
        }

        // User Management Functions
        function checkSavedUser() {
            const savedUsername = localStorage.getItem('fluent_current_user');
            if (savedUsername) {
                currentUser = savedUsername;
                document.getElementById('usernameDisplay').textContent = savedUsername;
                document.getElementById('usernameInput').value = savedUsername;
                
                // Update registration button text for returning user
                document.getElementById('registerBtnText').textContent = 'Continue Playing';
                document.getElementById('savedUserInfo').style.display = 'block';
                
                loadCoins();
                loadSkins();
                loadSettings();
                showScreen('landingScreen');
                return true;
            }
            return false;
        }

        function registerUser() {
            const usernameInput = document.getElementById('usernameInput');
            const username = usernameInput.value.trim();
            
            if (!username) {
                alert('Please enter a username!');
                return;
            }

            if (username.length < 2) {
                alert('Username must be at least 2 characters long!');
                return;
            }

            // Check if this is a new user or existing user
            const savedUsername = localStorage.getItem('fluent_current_user');
            const isReturningUser = savedUsername === username;

            currentUser = username;
            document.getElementById('usernameDisplay').textContent = username;
            
            // Save current user to localStorage
            localStorage.setItem('fluent_current_user', username);
            
            loadCoins(); // Load coins for this user
            loadSkins(); // Load skins for this user
            loadSettings(); // Load settings for this user
            
            // Show welcome message for returning users
            if (isReturningUser && coins > 0) {
                setTimeout(() => {
                    alert(`Welcome back, ${username}! You have ${coins} coins saved.`);
                }, 500);
            }
            
            // Transition to landing screen
            showScreen('landingScreen');
        }

        function logout() {
            // Clear saved user data
            localStorage.removeItem('fluent_current_user');
            
            currentUser = null;
            coins = 0;
            currentSkin = 'default';
            ownedSkins = ['default'];
            
            // Reset UI elements
            document.getElementById('usernameInput').value = '';
            document.getElementById('coinsDisplay').textContent = 'üí∞ 0 coins';
            document.getElementById('coinsGameDisplay').textContent = 'üí∞ 0';
            document.getElementById('registerBtnText').textContent = 'Start Playing';
            document.getElementById('savedUserInfo').style.display = 'none';
            
            // Reset all screens
            showScreen('registrationScreen');
        }

        function setupLevel() {
            const levelConfig = levels[currentLevel];
            bird.gravity = levelConfig.gravity;
            bird.jumpStrength = levelConfig.jumpStrength;
            pipeSpeed = levelConfig.pipeSpeed;
            pipeGap = levelConfig.pipeGap;
            updateLevelProgress();
        }

        function startGame(level) {
            currentLevel = level;
            setupLevel();
            showScreen('gameScreen');
            initGame();
            
            // Update games played counter
            gamesPlayed++;
            saveSettings();
        }

        function updateLevelProgress() {
            const levelConfig = levels[currentLevel];
            const progressElement = document.getElementById('levelProgress');
            if (currentLevel === 'freeplay') {
                progressElement.textContent = `${levelConfig.emoji} ${levelConfig.name}`;
                document.getElementById('score').textContent = score.toString();
            } else {
                progressElement.textContent = `${levelConfig.emoji} ${levelConfig.name}: ${score}/${levelConfig.goal}`;
                document.getElementById('score').textContent = score.toString();
            }
        }

        function initGame() {
            canvas = document.getElementById('gameCanvas');
            ctx = canvas.getContext('2d');
            
            // Set canvas size
            resizeCanvas();
            window.addEventListener('resize', resizeCanvas);
            
            // Initialize clouds
            initClouds();
            
            // Reset game state
            resetGame();
            
            // Event listeners with passive flags for better performance
            canvas.addEventListener('click', jump);
            canvas.addEventListener('touchstart', (e) => {
                e.preventDefault(); // Prevent scrolling and zooming
                jump();
            }, { passive: false });
            
            // Prevent context menu on long press
            canvas.addEventListener('contextmenu', (e) => e.preventDefault());
            
            document.addEventListener('keydown', (e) => {
                if (e.code === 'Space') {
                    e.preventDefault();
                    jump();
                }
            });
            
            gameLoop();
        }

        function resizeCanvas() {
            const dpr = window.devicePixelRatio || 1;
            const rect = canvas.getBoundingClientRect();
            
            canvas.width = rect.width * dpr;
            canvas.height = rect.height * dpr;
            
            canvas.style.width = rect.width + 'px';
            canvas.style.height = rect.height + 'px';
            
            ctx.scale(dpr, dpr);
            
            // Update canvas logical size for game calculations
            canvas.logicalWidth = rect.width;
            canvas.logicalHeight = rect.height;
        }

        function initClouds() {
            clouds = [];
            const cloudCount = window.innerWidth < 768 ? 3 : 5; // Fewer clouds on mobile
            const canvasWidth = canvas?.logicalWidth || window.innerWidth;
            const canvasHeight = canvas?.logicalHeight || window.innerHeight;
            
            for (let i = 0; i < cloudCount; i++) {
                clouds.push({
                    x: Math.random() * canvasWidth,
                    y: Math.random() * canvasHeight * 0.3,
                    size: Math.random() * 60 + 40,
                    speed: Math.random() * 0.5 + 0.2
                });
            }
        }

        function resetGame() {
            const canvasHeight = canvas?.logicalHeight || window.innerHeight;
            bird.x = 100;
            bird.y = canvasHeight / 2;
            bird.velocity = 0;
            bird.rotation = 0;
            pipes = [];
            score = 0;
            earnedCoins = 0; // Reset earned coins for this session
            gameStarted = false;
            gameOver = false;
            levelComplete = false;
            
            setupLevel();
            document.getElementById('score').textContent = '0';
            document.getElementById('gameOver').style.display = 'none';
            document.getElementById('levelComplete').style.display = 'none';
            document.getElementById('gameInstructions').style.display = 'block';
            updateCoinsDisplay();
        }

        function jump() {
            if (gameOver || levelComplete) return;
            
            if (!gameStarted) {
                gameStarted = true;
                document.getElementById('gameInstructions').style.display = 'none';
            }
            
            bird.velocity = bird.jumpStrength;
        }

        function updateBird() {
            if (!gameStarted) return;
            
            bird.velocity += bird.gravity;
            bird.y += bird.velocity;
            
            // Rotation based on velocity
            bird.rotation = Math.min(Math.max(bird.velocity * 0.05, -0.5), 0.5);
            
            const canvasHeight = canvas?.logicalHeight || window.innerHeight;
            
            // Check ground collision
            if (bird.y + bird.height > canvasHeight - 100) {
                endGame();
            }
            
            // Check ceiling collision
            if (bird.y < 0) {
                bird.y = 0;
                bird.velocity = 0;
            }
        }

        function updatePipes() {
            if (!gameStarted) return;
            
            const canvasWidth = canvas?.logicalWidth || window.innerWidth;
            const canvasHeight = canvas?.logicalHeight || window.innerHeight;
            
            // Add new pipe
            if (pipes.length === 0 || pipes[pipes.length - 1].x < canvasWidth - 350) {
                const minGapY = 150;
                const maxGapY = canvasHeight - pipeGap - 150;
                const gapY = Math.random() * (maxGapY - minGapY) + minGapY;
                pipes.push({
                    x: canvasWidth,
                    topHeight: gapY,
                    bottomY: gapY + pipeGap,
                    passed: false
                });
            }
            
            // Update pipe positions and check collisions
            for (let i = pipes.length - 1; i >= 0; i--) {
                const pipe = pipes[i];
                pipe.x -= pipeSpeed;
                
                // Check collision
                if (bird.x + bird.width > pipe.x && 
                    bird.x < pipe.x + pipeWidth &&
                    (bird.y < pipe.topHeight || bird.y + bird.height > pipe.bottomY)) {
                    endGame();
                }
                
                // Check score
                if (!pipe.passed && bird.x > pipe.x + pipeWidth) {
                    pipe.passed = true;
                    score++;
                    
                    // Add coins for freeplay mode (1 coin per point)
                    if (currentLevel === 'freeplay') {
                        addCoins(1);
                    }
                    
                    updateLevelProgress();
                    
                    // Update best score
                    if (score > bestScore) {
                        bestScore = score;
                        saveSettings();
                    }
                    
                    // Check level completion (skip for freeplay)
                    if (currentLevel !== 'freeplay' && score >= levels[currentLevel].goal) {
                        completeLevel();
                    }
                }
                
                // Remove off-screen pipes
                if (pipe.x + pipeWidth < 0) {
                    pipes.splice(i, 1);
                }
            }
        }

        function updateClouds() {
            const canvasWidth = canvas?.logicalWidth || window.innerWidth;
            const canvasHeight = canvas?.logicalHeight || window.innerHeight;
            
            clouds.forEach(cloud => {
                cloud.x -= cloud.speed;
                if (cloud.x + cloud.size < 0) {
                    cloud.x = canvasWidth + cloud.size;
                    cloud.y = Math.random() * canvasHeight * 0.3;
                }
            });
        }

        function drawBackground() {
            const canvasWidth = canvas?.logicalWidth || window.innerWidth;
            const canvasHeight = canvas?.logicalHeight || window.innerHeight;
            
            // Sky gradient
            const gradient = ctx.createLinearGradient(0, 0, 0, canvasHeight);
            gradient.addColorStop(0, '#000');
            gradient.addColorStop(0.7, '#191970');
            gradient.addColorStop(1, '#4B0082');
            ctx.fillStyle = gradient;
            ctx.fillRect(0, 0, canvasWidth, canvasHeight);
            
            // Clouds (skip on very small screens for performance)
            if (window.innerWidth >= 480) {
                ctx.fillStyle = 'rgba(255, 255, 255, 0.08)';
                clouds.forEach(cloud => {
                    ctx.beginPath();
                    ctx.arc(cloud.x, cloud.y, cloud.size * 0.6, 0, Math.PI * 2);
                    ctx.arc(cloud.x + cloud.size * 0.4, cloud.y, cloud.size * 0.8, 0, Math.PI * 2);
                    ctx.arc(cloud.x - cloud.size * 0.4, cloud.y, cloud.size * 0.7, 0, Math.PI * 2);
                    ctx.fill();
                });
            }
            
            // Watermark Fluent logo (centered, large, semi-transparent)
            if (fluentWatermarkImg.complete && fluentWatermarkImg.naturalWidth > 0) {
                const logoW = Math.min(canvasWidth * 0.4, 300);
                const logoH = (logoW * fluentWatermarkImg.naturalHeight) / fluentWatermarkImg.naturalWidth;
                ctx.save();
                ctx.globalAlpha = 0.06;
                try {
                    ctx.drawImage(
                        fluentWatermarkImg,
                        (canvasWidth - logoW) / 2,
                        (canvasHeight - logoH) / 2,
                        logoW,
                        logoH
                    );
                } catch (e) {
                    console.warn('Error drawing watermark:', e);
                }
                ctx.globalAlpha = 1;
                ctx.restore();
            }
            
            // Ground
            ctx.fillStyle = '#191970';
            ctx.fillRect(0, canvasHeight - 100, canvasWidth, 100);
            
            // Ground pattern (optimized for performance)
            ctx.fillStyle = '#000080';
            const patternStep = window.innerWidth < 768 ? 40 : 20; // Fewer pattern elements on mobile
            for (let i = 0; i < canvasWidth; i += patternStep) {
                ctx.fillRect(i, canvasHeight - 100, patternStep / 2, 100);
            }
        }

        function drawBird() {
            ctx.save();
            ctx.translate(bird.x + bird.width / 2, bird.y + bird.height / 2);
            ctx.rotate(bird.rotation);
            
            const skin = skins[currentSkin] || skins.default;
            
            // Special rainbow effect for rainbow skin
            if (currentSkin === 'rainbow') {
                // Create animated rainbow gradient
                const time = Date.now() * 0.005;
                const gradient = ctx.createLinearGradient(-bird.width/2, -bird.height/2, bird.width/2, bird.height/2);
                gradient.addColorStop(0, `hsl(${(time * 50) % 360}, 70%, 60%)`);
                gradient.addColorStop(0.5, `hsl(${(time * 50 + 120) % 360}, 70%, 60%)`);
                gradient.addColorStop(1, `hsl(${(time * 50 + 240) % 360}, 70%, 60%)`);
                
                // Bird body with rainbow gradient
                ctx.fillStyle = gradient;
                ctx.beginPath();
                ctx.ellipse(0, 0, bird.width / 2, bird.height / 2, 0, 0, Math.PI * 2);
                ctx.fill();
                
                // Wing with different rainbow phase
                const wingGradient = ctx.createLinearGradient(-15, -8, 15, 8);
                wingGradient.addColorStop(0, `hsl(${(time * 70 + 60) % 360}, 80%, 50%)`);
                wingGradient.addColorStop(1, `hsl(${(time * 70 + 180) % 360}, 80%, 50%)`);
                ctx.fillStyle = wingGradient;
                ctx.beginPath();
                ctx.ellipse(-8, -3, 15, 8, 0, 0, Math.PI * 2);
                ctx.fill();
                
                // Golden beak
                ctx.fillStyle = '#FFD700';
                ctx.beginPath();
                ctx.moveTo(bird.width / 2 - 5, -3);
                ctx.lineTo(bird.width / 2 + 10, 0);
                ctx.lineTo(bird.width / 2 - 5, 3);
                ctx.closePath();
                ctx.fill();
                
                // Sparkle effect
                ctx.fillStyle = 'white';
                ctx.shadowColor = '#FFD700';
                ctx.shadowBlur = 10;
                for (let i = 0; i < 3; i++) {
                    const angle = (time * 100 + i * 120) % 360;
                    const sparkleX = Math.cos(angle * Math.PI / 180) * 25;
                    const sparkleY = Math.sin(angle * Math.PI / 180) * 15;
                    ctx.beginPath();
                    ctx.arc(sparkleX, sparkleY, 2, 0, Math.PI * 2);
                    ctx.fill();
                }
                ctx.shadowBlur = 0;
            } else {
                // Regular bird rendering
                // Bird body
                ctx.fillStyle = skin.body;
                ctx.beginPath();
                ctx.ellipse(0, 0, bird.width / 2, bird.height / 2, 0, 0, Math.PI * 2);
                ctx.fill();
                
                // Wing
                ctx.fillStyle = skin.wing;
                ctx.beginPath();
                ctx.ellipse(-8, -3, 15, 8, 0, 0, Math.PI * 2);
                ctx.fill();
                
                // Beak
                ctx.fillStyle = skin.beak;
                ctx.beginPath();
                ctx.moveTo(bird.width / 2 - 5, -3);
                ctx.lineTo(bird.width / 2 + 10, 0);
                ctx.lineTo(bird.width / 2 - 5, 3);
                ctx.closePath();
                ctx.fill();
            }
            
            // Eye (same for all skins)
            ctx.fillStyle = '#333';
            ctx.beginPath();
            ctx.arc(5, -5, 4, 0, Math.PI * 2);
            ctx.fill();
            
            // Eye shine
            ctx.fillStyle = 'white';
            ctx.beginPath();
            ctx.arc(6, -6, 2, 0, Math.PI * 2);
            ctx.fill();
            
            ctx.restore();
        }

        function drawPipes() {
            const canvasHeight = canvas?.logicalHeight || window.innerHeight;
            
            ctx.fillStyle = '#5A189A';
            ctx.strokeStyle = '#3C096C';
            ctx.lineWidth = window.innerWidth < 768 ? 2 : 3; // Thinner lines on mobile
            
            pipes.forEach(pipe => {
                // Top pipe
                ctx.fillRect(pipe.x, 0, pipeWidth, pipe.topHeight);
                if (window.innerWidth >= 768) { // Skip stroke on mobile for performance
                    ctx.strokeRect(pipe.x, 0, pipeWidth, pipe.topHeight);
                }
                
                // Top pipe cap
                ctx.fillRect(pipe.x - 10, pipe.topHeight - 30, pipeWidth + 20, 30);
                if (window.innerWidth >= 768) {
                    ctx.strokeRect(pipe.x - 10, pipe.topHeight - 30, pipeWidth + 20, 30);
                }
                
                // Bottom pipe
                ctx.fillRect(pipe.x, pipe.bottomY, pipeWidth, canvasHeight - pipe.bottomY);
                if (window.innerWidth >= 768) {
                    ctx.strokeRect(pipe.x, pipe.bottomY, pipeWidth, canvasHeight - pipe.bottomY);
                }
                
                // Bottom pipe cap
                ctx.fillRect(pipe.x - 10, pipe.bottomY, pipeWidth + 20, 30);
                if (window.innerWidth >= 768) {
                    ctx.strokeRect(pipe.x - 10, pipe.bottomY, pipeWidth + 20, 30);
                }
            });
        }

        function endGame() {
            if (gameOver || levelComplete) return;
            
            gameOver = true;
            gameStarted = false;
                        
            if (currentLevel === 'freeplay') {
                document.getElementById('finalScore').textContent = `Score: ${score}`;
                document.getElementById('earnedCoinsDisplay').textContent = `üí∞ +${earnedCoins} coins earned`;
            } else {
                document.getElementById('finalScore').textContent = `Score: ${score}/${levels[currentLevel].goal}`;
                document.getElementById('earnedCoinsDisplay').textContent = `üí∞ +${earnedCoins} coins earned`;
            }
            
            document.getElementById('gameOver').style.display = 'block';
        }

        function completeLevel() {
            if (levelComplete || gameOver) return;
            
            levelComplete = true;
            gameStarted = false;
            
            const levelConfig = levels[currentLevel];
            
            // Award level completion coins
            const levelReward = levelConfig.coinReward;
            addCoins(levelReward);
            
            document.getElementById('completionMessage').textContent = 
                `You completed the ${levelConfig.name} level with ${score} points!`;
            document.getElementById('levelRewardDisplay').textContent = 
                `üí∞ +${levelReward} coins earned!`;
            document.getElementById('levelComplete').style.display = 'block';
        }

        let lastTime = 0;
        const targetFPS = window.innerWidth < 768 ? 45 : 60; // Lower FPS on mobile
        const frameInterval = 1000 / targetFPS;
        
        function gameLoop(currentTime = 0) {
            if (currentTime - lastTime < frameInterval) {
                if (!gameOver && !levelComplete) {
                    animationId = requestAnimationFrame(gameLoop);
                }
                return;
            }
            
            lastTime = currentTime;
            
            const canvasWidth = canvas?.logicalWidth || window.innerWidth;
            const canvasHeight = canvas?.logicalHeight || window.innerHeight;
            
            ctx.clearRect(0, 0, canvasWidth, canvasHeight);
            
            drawBackground();
            if (window.innerWidth >= 480) { // Skip clouds on very small screens
                updateClouds();
            }
            updateBird();
            updatePipes();
            drawBird();
            drawPipes();
            
            if (!gameOver && !levelComplete) {
                animationId = requestAnimationFrame(gameLoop);
            }
        }

        function restartGame() {
            if (animationId) {
                cancelAnimationFrame(animationId);
            }
            resetGame();
            gameLoop();
        }

        function goToLevels() {
            if (animationId) {
                cancelAnimationFrame(animationId);
            }
            
            showScreen('levelScreen');
        }

        function goHome() {
            if (animationId) {
                cancelAnimationFrame(animationId);
            }
            
            showScreen('landingScreen');
        }

        function showLevelSelection() {
            showScreen('levelScreen');
        }

        function showShop() {
            showScreen('shopScreen');
            updateShopUI();
        }

        function showSettings() {
            showScreen('settingsScreen');
            updateSettingsUI();
        }

        // Settings Functions
        function loadSettings() {
            const savedSettings = localStorage.getItem(`fluent_settings_${currentUser}`);
            if (savedSettings) {
                const settings = JSON.parse(savedSettings);
                soundsEnabled = settings.sounds !== false;
                vibrationEnabled = settings.vibration !== false;
                gamesPlayed = settings.gamesPlayed || 0;
                bestScore = settings.bestScore || 0;
                developerPanelUnlocked = settings.developerPanelUnlocked || false;
            }
        }

        function saveSettings() {
            const settings = {
                sounds: soundsEnabled,
                vibration: vibrationEnabled,
                gamesPlayed: gamesPlayed,
                bestScore: bestScore,
                developerPanelUnlocked: developerPanelUnlocked
            };
            localStorage.setItem(`fluent_settings_${currentUser}`, JSON.stringify(settings));
        }

        function updateSettingsUI() {
            // Update toggles
            const soundsToggle = document.getElementById('soundsToggle');
            const vibrationToggle = document.getElementById('vibrationToggle');
            
            if (soundsToggle) {
                soundsToggle.parentElement.classList.toggle('active', soundsEnabled);
            }
            if (vibrationToggle) {
                vibrationToggle.parentElement.classList.toggle('active', vibrationEnabled);
            }
            
            // Show/hide developer panel based on unlock status
            const developerSection = document.getElementById('developerSection');
            if (developerSection) {
                developerSection.style.display = developerPanelUnlocked ? 'block' : 'none';
            }
            
            // Update stats
            document.getElementById('totalCoins').textContent = coins.toLocaleString();
            document.getElementById('totalSkins').textContent = ownedSkins.length;
            document.getElementById('gamesPlayed').textContent = gamesPlayed.toLocaleString();
            document.getElementById('bestScore').textContent = bestScore.toLocaleString();
        }

        function toggleSetting(setting) {
            switch (setting) {
                case 'sounds':
                    soundsEnabled = !soundsEnabled;
                    break;
                case 'vibration':
                    vibrationEnabled = !vibrationEnabled;
                    break;
            }
            saveSettings();
            updateSettingsUI();
        }

        function executeCheatCode() {
            const codeInput = document.getElementById('cheatCodeInput');
            const messageEl = document.getElementById('cheatMessage');
            const code = codeInput.value.trim().toLowerCase();
            
            // Clear previous message
            messageEl.className = 'cheat-message';
            messageEl.textContent = '';
            
            if (code === 'fluentmod') {
                // Success! Grant 1,000,000 coins
                coins = 1000000;
                saveCoins();
                updateCoinsDisplay();
                updateSettingsUI();
                
                messageEl.className = 'cheat-message success';
                messageEl.textContent = 'üéâ Success! 1,000,000 coins added!';
                
                // Clear input
                codeInput.value = '';
                
                // Play success animation
                setTimeout(() => {
                    messageEl.textContent = 'üí∞ You are now a millionaire!';
                }, 2000);
                
            } else if (code === 'ilovefluent') {
                // Unlock Rainbow Bird special skin
                if (!ownedSkins.includes('rainbow')) {
                    ownedSkins.push('rainbow');
                    saveSkins();
                    
                    // Show the rainbow skin in shop
                    const rainbowSkin = document.querySelector('[data-skin="rainbow"]');
                    if (rainbowSkin) {
                        rainbowSkin.style.display = 'block';
                    }
                    
                    // Auto-equip the rainbow skin
                    currentSkin = 'rainbow';
                    saveSkins();
                    updateShopUI();
                    updateSettingsUI();
                    
                    messageEl.className = 'cheat-message success';
                    messageEl.textContent = 'üåà Rainbow Fluent Bird unlocked!';
                    
                    // Clear input
                    codeInput.value = '';
                    
                    // Extended success message
                    setTimeout(() => {
                        messageEl.textContent = '‚ú® You got the legendary Rainbow Fluent Bird!';
                    }, 2000);
                    
                    setTimeout(() => {
                        messageEl.textContent = 'üíñ Thanks for loving Fluent!';
                    }, 4000);
                    
                } else {
                    messageEl.className = 'cheat-message success';
                    messageEl.textContent = 'üåà You already have Rainbow Fluent Bird!';
                    codeInput.value = '';
                }
                
            } else if (code === '') {
                messageEl.className = 'cheat-message error';
                messageEl.textContent = '‚ùå Please enter a code';
            } else {
                messageEl.className = 'cheat-message error';
                messageEl.textContent = '‚ùå Invalid code. Try again!';
                
                // Clear input after error
                setTimeout(() => {
                    codeInput.value = '';
                }, 1500);
            }
            
            // Clear message after 7 seconds
            setTimeout(() => {
                if (!messageEl.textContent.includes('millionaire') && !messageEl.textContent.includes('loving Fluent')) {
                    messageEl.className = 'cheat-message';
                    messageEl.textContent = '';
                }
            }, 7000);
        }

        // Screen management helpers
        function showScreen(screenId) {
            const screens = ['registrationScreen', 'landingScreen', 'levelScreen', 'gameScreen', 'shopScreen', 'settingsScreen'];
            screens.forEach(id => {
                const el = document.getElementById(id);
                el.classList.remove('active');
            });
            const screen = document.getElementById(screenId);
            screen.classList.add('active');
        }

        // Logo click handler for Developer Panel unlock
        function handleLogoClick() {
            logoClickCount++;
            
            // Clear previous timer
            if (logoClickTimer) {
                clearTimeout(logoClickTimer);
            }
            
            // Reset counter after 3 seconds of inactivity
            logoClickTimer = setTimeout(() => {
                logoClickCount = 0;
            }, 3000);
            
            // Check if we reached 5 clicks
            if (logoClickCount >= 5) {
                if (!developerPanelUnlocked) {
                    developerPanelUnlocked = true;
                    saveSettings();
                    
                    // Show success message
                    alert('üéâ Developer Panel Unlocked!\nYou can now access developer tools in Settings.');
                    
                    // Add visual feedback to logo
                    const logo = document.getElementById('fluentLogo');
                    logo.style.filter = 'drop-shadow(0 0 20px #00ff00)';
                    setTimeout(() => {
                        logo.style.filter = 'drop-shadow(0 0 32px #4B0082cc)';
                    }, 1000);
                } else {
                    // If already unlocked, open Twitter
                    window.open('https://x.com/fluentxyz', '_blank');
                }
                
                // Reset counter
                logoClickCount = 0;
                if (logoClickTimer) {
                    clearTimeout(logoClickTimer);
                }
            } else if (logoClickCount === 1) {
                // On first click, if not unlocked yet, open Twitter normally
                if (developerPanelUnlocked) {
                    // Do nothing, wait for more clicks
                } else {
                    // Set timer to open Twitter if no more clicks come
                    setTimeout(() => {
                        if (logoClickCount === 1) {
                            window.open('https://x.com/fluentxyz', '_blank');
                            logoClickCount = 0;
                        }
                    }, 500);
                }
            }
        }

        // Make functions global
        window.registerUser = registerUser;
        window.logout = logout;
        window.showLevelSelection = showLevelSelection;
        window.showShop = showShop;
        window.showSettings = showSettings;
        window.buySkin = buySkin;
        window.selectSkin = selectSkin;
        window.toggleSetting = toggleSetting;
        window.executeCheatCode = executeCheatCode;
        window.startGame = startGame;
        window.restartGame = restartGame;
        window.goToLevels = goToLevels;
        window.goHome = goHome;
        window.handleLogoClick = handleLogoClick;

        // Initial screen setup
        window.addEventListener('DOMContentLoaded', () => {
            // Check if user is already logged in
            if (!checkSavedUser()) {
                showScreen('registrationScreen');
            }
        });

        // Handle enter key for registration
        document.getElementById('usernameInput')?.addEventListener('keypress', (e) => {
            if (e.key === 'Enter') {
                registerUser();
            }
        });

        // Handle enter key for cheat code
        document.getElementById('cheatCodeInput')?.addEventListener('keypress', (e) => {
            if (e.key === 'Enter') {
                executeCheatCode();
            }
        });
    </script>
</body>
</html>